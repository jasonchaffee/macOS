#!/usr/bin/env zsh

# Usage: install-tools <type> [failure_log]
# Installs all tools of the given type from tools.conf

BASE_DIR=$( cd $( dirname ${(%):-%x} ) &> /dev/null && pwd )
source ${BASE_DIR}/colors

type=$1
failure_log=$2

grep "^${type}:" ${BASE_DIR}/../tools.conf | while read entry; do
    [[ -z "$entry" ]] && continue
    ${BASE_DIR}/install-tool "$entry" </dev/null
    if [[ $? -ne 0 ]]; then
        clean=${entry%%#*}
        clean=${clean%% *}
        pkg=${clean#*:}
        echo -e "  ${RED}âœ—${NC} ${type}: ${BOLD}$pkg${NC}" >> $failure_log
    fi
done
