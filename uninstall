#!/usr/bin/env zsh

BASE_DIR=$( cd $( dirname ${(%):-%x} ) &> /dev/null && pwd )

# Uninstall tools with custom configs first
${BASE_DIR}/vim/uninstall
${BASE_DIR}/git/uninstall

# Uninstall npm packages (before removing node)
while read entry; do
    ${BASE_DIR}/lib/uninstall-tool "$entry" </dev/null
done < <(grep '^npm:' ${BASE_DIR}/tools.conf)

# Uninstall brew casks
while read entry; do
    ${BASE_DIR}/lib/uninstall-tool "$entry" </dev/null
done < <(grep '^brew-cask:' ${BASE_DIR}/tools.conf)

# Uninstall mise-managed tools
while read entry; do
    ${BASE_DIR}/lib/uninstall-tool "$entry" </dev/null
done < <(grep '^mise:' ${BASE_DIR}/tools.conf)

# Uninstall mise
${BASE_DIR}/mise/uninstall

# Uninstall shell configs
${BASE_DIR}/bash/uninstall
${BASE_DIR}/zsh/uninstall

# Uninstall brew packages (antidote before brew)
while read entry; do
    ${BASE_DIR}/lib/uninstall-tool "$entry" </dev/null
done < <(grep '^brew:' ${BASE_DIR}/tools.conf | tail -r)

# Bootstrap cleanup: brew last
${BASE_DIR}/brew/uninstall
