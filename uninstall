#!/usr/bin/env zsh

BASE_DIR=$( cd $( dirname ${(%):-%x} ) &> /dev/null && pwd )

# Uninstall tools with custom configs first
${BASE_DIR}/vim/uninstall
${BASE_DIR}/git/uninstall

# Uninstall npm packages (before removing node)
grep '^npm:' ${BASE_DIR}/tools.conf | while read entry; do
    ${BASE_DIR}/lib/uninstall-tool "$entry"
done

# Uninstall brew casks
grep '^brew-cask:' ${BASE_DIR}/tools.conf | while read entry; do
    ${BASE_DIR}/lib/uninstall-tool "$entry"
done

# Uninstall mise-managed tools
grep '^mise:' ${BASE_DIR}/tools.conf | while read entry; do
    ${BASE_DIR}/lib/uninstall-tool "$entry"
done

# Uninstall mise
${BASE_DIR}/mise/uninstall

# Uninstall shell configs
${BASE_DIR}/bash/uninstall
${BASE_DIR}/zsh/uninstall

# Uninstall brew packages (antidote before brew)
grep '^brew:' ${BASE_DIR}/tools.conf | tac | while read entry; do
    ${BASE_DIR}/lib/uninstall-tool "$entry"
done

# Bootstrap cleanup: brew last
${BASE_DIR}/brew/uninstall
